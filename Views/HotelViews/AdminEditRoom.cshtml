@model Project.Models.Rooms
@{
    var count = 0;
    var count1 = 0;
}
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="~/Image/sea.png" type="image/x-icon">
    <link rel="stylesheet" href="~/css/Admin.css">
    <link rel="stylesheet" href="~/css/Checkbox.css">
    <link rel="stylesheet" href="~/css/Button.css">
    <script src="https://kit.fontawesome.com/d85c1eb16f.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/js/Admin.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-rough"></script>
    <script src="~/lib/jquery-validation/dist/jquery.validate.min.js"></script>
    <script src="~/lib/jquery-validation-unobtrusive/jquery.validate.unobtrusive.min.js"></script>
    <title>Hotel Dashboard</title>
</head>

<body>
    <div class="container">
        <div class="navigation">
            <ul class="nav-ul">
                <li>
                    <a class="btn1">
                        <span class="icon"><img src="~/Image/svgpng.com/item (118).png" alt="" style="width: 45px;"></span>
                        <span class="tittle">Ocean Hotel</span>
                    </a>
                </li>
                <li>
                    <a class="btn2" href="/DashBoard/AdminDashBoard">
                        <span class="icon"><i class="fa-solid fa-house"></i></span>
                        <span class="tittle">Dashboard</span>
                    </a>
                </li>
                <li>
                    <a class="btn3">
                        <span class="icon"><i class="fa-solid fa-people-group"></i></span>
                        <span class="tittle">Booking <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="all-booking-button" href="/Booking/AdminBooking">All Booking</a></li>
                        <li><a class="edit-booking-button" href="/Booking/AdminEditBooking">Edit Booking</a></li>
                        <li><a class="add-booking-button" href="/Booking/AdminAddBooking">Add Booking</a></li>
                        <li><a class="add-booking-button" href="/Booking/AdminBookingDetails">Booking Details</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn4 hovered">
                        <span class="icon"><i class="fas fa-bed"></i></span>
                        <span class="tittle">Rooms <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul active-li">
                        <li><a class="all-room-button" href="/Room/AdminRoom">All Rooms</a></li>
                        <li class="active"><a class="edit-room-button" href="/Room/AdminEditRoom">Edit Room</a></li>
                        <li><a class="add-room-button" href="/Room/AdminAddRoom">Add Room</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn5">
                        <span class="icon"><i class="fa-solid fa-user"></i></span>
                        <span class="tittle">Customers <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="all-customer-button" href="/Customer/AdminCustomer">All Customers</a></li>
                        <li><a class="edit-customer-button" href="/Customer/AdminEditCustomer">Edit Customer</a></li>
                        <li><a class="add-customer-button" href="/Customer/AdminAddCustomer">Add Customer</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn6">
                        <span class="icon"><i class="fa-solid fa-user"></i></span>
                        <span class="tittle">Employees <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="all-employee-button" href="/Employee/AdminEmployee">All Employees</a></li>
                        <li><a class="edit-employee-button" href="/Employee/AdminEditEmployee">Edit Employee</a></li>
                        <li><a class="add-employee-button" href="/Employee/AdminAddEmployee">Add Employee</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn7">
                        <span class="icon"><i class="fas fa-concierge-bell"></i></span>
                        <span class="tittle">Services <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="service-button" href="/Service/AdminServices">All Services</a></li>
                        <li><a class="shuttle-button" href="/Service/AdminShuttle">Shuttle Services</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn16">
                        <span class="icon"><i class="fa-solid fa-couch"></i></span>
                        <span class="tittle">Furniture <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="all-furniture-button" href="/Furniture/AdminFurniture">All Furniture</a></li>
                        <li><a class="edit-furniture-button" href="/Furniture/AdminEditFurniture">Edit Furniture</a></li>
                        <li><a class="add-furniture-button" href="/Furniture/AdminAddFurniture">Add Furniture</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn8" href="/Promotion/AdminPricing">
                        <span class="icon"><i class="fa-solid fa-money-bill-wave"></i></span>
                        <span class="tittle">Pricing</span>
                    </a>
                </li>
                <li>
                    <a class="btn9">
                        <span class="icon"><i class="fa-solid fa-clipboard-user"></i></span>
                        <span class="tittle">Staff <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="leave-button" href="/Employee/AdminLeave">Leave</a></li>
                        <li><a class="attendance-button" href="/Employee/AdminAttendance">Attandance</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn10">
                        <span class="icon"><i class="fa-solid fa-van-shuttle"></i></span>
                        <span class="tittle">Accounting <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="invoice-button" href="/Invoice/AdminInvoice">Invoices</a></li>
                        <li><a class="payment-button" href="/Payment/AdminPayment">Payments</a></li>
                        <li><a class="Expenses-button" href="/Expense/AdminExpense">Expenses</a></li>
                        <li><a class="Taxes-button" href="/Taxes/AdminTaxes">Taxes</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn11">
                        <span class="icon"><i class="fa-solid fa-book"></i></span>
                        <span class="tittle">Payroll <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="employee-salary-button" href="/Employee/AdminEmployeeSalary">Employee Salary</a>
                        </li>
                        <li><a class="payslip-button" href="/Employee/AdminPayslip">Payslip</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn12">
                        <span class="icon"><i class="fas fa-chart-bar"></i></span>
                        <span class="tittle">Chart <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="bar-button" href="/Chart/AdminBarChart">Bar Chart</a></li>
                        <li><a class="line-button" href="/Chart/AdminLineChart">Line Chart</a></li>
                        <li><a class="pie-button" href="/Chart/AdminPieChart">Pie Chart</a></li>
                        <li><a class="donut-button" href="/Chart/AdminDonutChart">Donut Chart</a></li>
                        <li><a class="mixed-button" href="/Chart/AdminMixedChart">Mixed Chart</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn13">
                        <span class="icon"><i class="fa-solid fa-chart-simple"></i></span>
                        <span class="tittle">Reports <i class="fas fa-caret-right"></i></span>
                    </a>
                    <ul class="nav-sub-ul">
                        <li><a class="expense-report-button" href="/Expense/AdminExpenseReport">Expense Report</a></li>
                        <li><a class="invoice-report-button" href="/Invoice/AdminInvoiceReport">Invoice Report</a></li>
                    </ul>
                </li>
                <li>
                    <a class="btn14">
                        <span class="icon"><i class="fa-solid fa-gear"></i></span>
                        <span class="tittle">Setting</span>
                    </a>
                </li>
                <li>
                    <a class="btn15" asp-action="SignOut1" asp-controller="Login">
                        <span class="icon"><i class="fa-solid fa-arrow-right-from-bracket"></i></span>
                        <span class="tittle">Sign Out</span>
                    </a>
                </li>
            </ul>
        </div>
        <!-- ==============================main============================ -->
        <div class="main">
            <div class="top-bar">
                <div class="toggle"><i class="fa-solid fa-bars"></i></div>
                <div class="search">
                </div>
                <div id="change-dark-mode">
                    <i class="fa-solid fa-sun"></i>
                </div>
                <div class="user-role-name">
                    <div class="user">
                        <img src="~/Image/Avatar/@ViewBag.employee_avatar.img" alt="">
                    </div>
                    <div class="role-name">
                        <span class="user1"style="font-size: 18px;">@ViewBag.employee_avatar.name</span><br>
                        <span class="user2"style="font-size: 14px;">@ViewBag.employee_avatar.role</span>
                    </div>
                </div>
            </div>
            <!-- ==============================Card============================== -->
            <div class="sub-main">
                <div class="article-11">
                    <div class="box-tittle-1">
                        <p>Edit Room</p>
                        <img src="~/Image/svgpng.com/item (234).png" alt="">
                    </div>
                    <div>
                        <form method="post" asp-controller="Room" asp-action="AdminUpdateRoom" enctype="multipart/form-data">
                            <div class="box-context">
                            <div class="sub-main-bottom sub-bg background_bg1">
                                <div class="main-col">
                                    <div><label>Room ID</label></div>
                                    <select asp-for="id" id="room_id">
                                        @foreach (var room1 in ViewBag.rooms_list)
                                        {
                                            <option value="@room1.id">@room1.id - @room1.name</option>
                                        }
                                    </select>
                                    @Html.ValidationMessageFor(m => m.id)
                                </div>
                                <div class="main-col">
                                    <div><label>Room Name</label></div>
                                    <input type="text" asp-for="name" id="room_name" placeholder="room name">
                                    @Html.ValidationMessageFor(m => m.name)
                                </div>
                                <div class="main-col">
                                    <div><label>Room Type</label></div>
                                    <select asp-for="type" id="room_type">
                                        <option>Select</option>
                                        <option>Standard</option>
                                        <option>Superior</option>
                                        <option>Deluxe</option>
                                        <option>Suite</option>
                                    </select>
                                    @Html.ValidationMessageFor(m => m.type)
                                </div>
                                <div class="main-col">
                                    <div><label>Room floor</label></div>
                                    <input type="text" asp-for="floor" id="room_floor" placeholder="1">
                                    @Html.ValidationMessageFor(m => m.floor)
                                </div>
                                <div class="main-col">
                                    <div><label>Room size</label></div>
                                    <input type="text" asp-for="size" id="room_size" placeholder="15x25">
                                    @Html.ValidationMessageFor(m => m.size)
                                </div>
                                <div class="main-col">
                                    <div><label>Status</label></div>
                                    <select asp-for="status">
                                        <option>Active</option>
                                        <option>Inactive</option>
                                    </select>
                                    @Html.ValidationMessageFor(m => m.status)
                                </div>
                                <div class="main-col">
                                    <div><label>View</label></div>
                                    <select asp-for="view!.name" id="room_view">
                                        <option>Sea View</option>
                                        <option>Pool View</option>
                                        <option>Mountain View</option>
                                        <option>City View</option>
                                    </select>
                                    @Html.ValidationMessageFor(m => m.view!.name)
                                </div>
                                <div class="main-col">
                                    <div><label>Price</label></div>
                                    <input type="text" asp-for="price" id="room_price" placeholder="$ 0.00">
                                    @Html.ValidationMessageFor(m => m.price)
                                </div>
                                <div class="main-col">
                                    <div><label>Furniture</label></div>
                                    <div class="box-box">
                                        
                                            @foreach (var furniture in ViewBag.furnitures_list)
                                            {
                                                <div class="checkbox-wrapper-2">
                                                    <input id="example-@count" class="substituted myCheckbox" type="checkbox"
                                                        aria-hidden="true" data-target="text-@count" 
                                                        @(Model.furnitures!.Any(furnitures => furnitures.name!.Equals(furniture.name)) ? "checked" : "")/>
                                                    <label for="example-@count">@furniture.name</label>
                                                    <input type="number" asp-for="@Model.furnitures![@count].quanity"
                                                        id="number-@count" class="direct" 
                                                        value="@(Model.furnitures!.Any(furnitures => furnitures.name!.Equals(furniture.name)) ? @furniture.quanity : "0")">
                                                </div>
                                                <input type="hidden" asp-for="@Model.furnitures![@count].name" id="text-@count"
                                                    value="@(Model.furnitures!.Any(furnitures => furnitures?.name?.Equals(furniture.name)) ? @furniture.name : "")">
                                                count++;
                                            }
                                        
                                    </div>
                                </div>
                                <div class="main-col">
                                    <div><label>Amenities</label></div>
                                    <div class="box-box">
                                        
                                            @foreach (var amenities in ViewBag.amenities_list)
                                            {
                                                <div class="checkbox-wrapper-2">
                                                    <input id="example-@count" class="substituted myCheckbox" type="checkbox"
                                                        aria-hidden="true" data-target="text-@count" 
                                                        @(Model.amenities!.Any(amenities1 => amenities1.name!.Equals(amenities.name)) ? "checked" : "")/>
                                                    <label for="example-@count">@amenities.name</label>
                                                    <input type="number" asp-for="@Model.amenities![@count1].quantity"
                                                        id="number-@count" class="direct" 
                                                        value="@(Model.amenities!.Any(amenities1 => amenities1?.name?.Equals(amenities.name)) ? @amenities.quantity : "0")">
                                                </div>
                                                <input type="hidden" asp-for="@Model.amenities![@count1].name" id="text-@count"
                                                    value="@(Model.amenities!.Any(amenities1 => amenities?.name?.Equals(amenities.name)) ? @amenities.name : "")">
                                                count1++;
                                                count++;
                                            }
                                        
                                    </div>
                                </div>
                                <div class="main-col">
                                    <div><label>Upload Image</label></div>
                                    <input type="file" name="file" id="">
                                </div>
                            </div>
                            <div class="box-img">
                                @if(Model != null){
                                    <div class="box-img-1"><img src="~/Image/@Model.img" alt="" id="box_img"></div>
                                }else{
                                    <div class="box-img-1"><img src="~/Image/pic3.084e84fc095022101602.png" alt="" id="box_img"></div>
                                }
                                <div class="mini-box-circle">
                                    <div class="icon-room"><i class="fa-solid fa-key"></i></div>
                                    <div class="box-text-2">
                                        <div class="box_id" style="color:cornflowerblue;" id="box_id">RO-<input type="text" asp-for="id" id="input_id" class="box-input" readonly></div>
                                        <div class="box_name" id="box_name"><input type="text" asp-for="name" id="input_name" class="box-input" readonly></div>
                                    </div>
                                </div>
                                <div class="mini-box-circle">
                                    <div class="box-circle"><i class="fa-solid fa-florin-sign"></i></div>
                                    <div class="text-center" id="box_floor"><input type="text" asp-for="floor" id="input_floor" class="box-input" readonly></div>
                                </div>
                                <div class="mini-box-circle">
                                    <div class="box-circle"><i class="fa-solid fa-maximize"></i></div>
                                    <div class="text-center" id="box_size"><input type="text" asp-for="size" id="input_size" class="box-input" readonly></div>
                                </div>
                                <div class="mini-box-circle">
                                    <div class="box-circle"><i class="fa-solid fa-cart-flatbed"></i></div>
                                    <div class="text-center" id="box_type"><input type="text" asp-for="type" id="input_type" class="box-input" readonly></div>
                                </div>
                                <div class="mini-box-circle">
                                    <div class="box-circle"><i class="fa-solid fa-money-check-dollar"></i></div>
                                    <div class="text-center" id="box_price" style="color:cornflowerblue;">Price: <input type="text" asp-for="price" id="input_price" class="box-input" readonly></div>
                                </div>
                                <div class="mini-box-circle">
                                    <div class="box-circle"><i class="fa-solid fa-check-double"></i></div>
                                    <div class="text-center" id="box_status"><input type="text" asp-for="status" id="input_status" class="box-input" readonly></div>
                                </div>
                            </div>
                            </div>
                            <div class="button-box">
                                <button type="submit" class="button-29">Save Room</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {
            if(status == "Active"){
                $('#input_status').addClass("active-status-1");
                $('#input_status').removeClass("inactive-status-1");
            }else{
                $('#input_status').addClass("inactive-status-1");
                $('#input_status').removeClass("active-status-1");
            }
            $('.myCheckbox').change(function () {
                var checkboxId = $(this).attr('id');
                var targetInputId = $(this).data('target');
                var labelValue = $('label[for="' + checkboxId + '"]').text();
                if ($(this).is(':checked')) {
                    $('#' + targetInputId).val(labelValue);
                    $(this).siblings('.direct').val(1);
                } else {
                    $('#' + targetInputId).val('');
                    $(this).siblings('.direct').val(0);
                }
            });
            $('#room_id').change(function () {
                var selectedOption = $(this).val();

                $.ajax({
                    type: "POST",
                    url: "/Room/GetRoomInfor",
                    data: { selectedOption: selectedOption },
                    success: function (response) {
                        $('#room_name').val(response.name);
                        $('#room_type').val(response.type);
                        $('#room_size').val(response.size);
                        $('#room_floor').val(response.floor);
                        $('#status').val(response.status);
                        $('#room_price').val(response.price);
                        $('#room_view').val(response.view);
                        var furniture_list = response.furnitures;
                        var amenities_list = response.amenities;
                        for (var j = 0; j < @count; j++) {
                            $('#example-' + j).prop('checked', false);
                        }
                        for (var i = 0; i < @count; i++){
                            $('#number-' + i).val("0");
                            console.log(i);
                        }
                        for (var i = 0; i < furniture_list.length; i++) {
                            var furnitureName = furniture_list[i].name;
                            var furnitureQuantity = furniture_list[i].quanity;
                            for (var j = i; j < @Model?.furnitures?.Count; j++) {
                                var labelContent = $('#example-' + j).next('label').text();
                                // So sánh furnitureName với nội dung của label
                                if (furnitureName == labelContent) {
                                    $('#example-' + j).prop('checked', true);
                                    $('#text-' + j).val(furnitureName);
                                    $('#number-' + j).val(furnitureQuantity);
                                    break;
                                }
                            }
                        }
                        for (var i = 0; i < amenities_list.length; i++) {
                            var amenitiesName = amenities_list[i].name;
                            var amenitiesQuantity = amenities_list[i].quantity;
                            for (var j = amenities_list.length; j < @count; j++) {
                                var labelContent = $('#example-' + j).next('label').text();
                                // So sánh amenitiesName với nội dung của label
                                if (amenitiesName == labelContent) {
                                    $('#example-' + j).prop('checked', true);
                                    $('#text-' + j).val(amenitiesName);
                                    $('#number-' + j).val(amenitiesQuantity);
                                    break;
                                }
                            }
                        }
                        $('#input_id').val(selectedOption)
                        $('#input_name').val(response.name);
                        $('#input_size').val(response.size);
                        $('#input_type').val(response.type);
                        $('#input_price').val(response.price);
                        $('#input_floor').val(response.floor);
                        $('#input_price').val(response.price);
                        var status =response.status;
                        if(status == "Active"){
                            $('#input_status').addClass("active-status-1");
                            $('#input_status').val("Available");
                            $('#input_status').removeClass("inactive-status-1");
                        }else{
                            $('#input_status').addClass("inactive-status-1");
                            $('#input_status').val("Booked");
                            $('#input_status').removeClass("active-status-1");
                        }
                        $('#box_img').attr("src","../Image/"+response.img);
                    },
                    error: function () {
                        alert("An error occurred while retrieving contact information.");
                    }
                });
            });
        });
    </script>
</body>

</html>